<div class="userForm">
  <h1 align = "center">User Details</h1>
  <form data-type="default" #f= 'ngForm' (submit)= 'f.form.valid && submit()' name="create-user-form" accept-charset="UTF-8" role="form">
    <div class="basicUserDetails">
      <mat-card class="userForm">
        <mat-card-header class="header">
          Basic details
        </mat-card-header>
        <mat-card-content>
      <mat-form-field class="input">
        <input matInput type="text" name="userName" [(ngModel)]= 'user.id' required [readonly] = 'updateMode' placeholder="Enter username">
      </mat-form-field>
      <mat-form-field class="input">
        <input matInput name = 'password'  [(ngModel)] = 'user.password' placeholder="Enter password" [type]="hide ? 'password' : 'text'">
        <button mat-icon-button matSuffix (click)="hide = !hide" [attr.aria-label]="'Hide password'" [attr.aria-pressed]="hide">
          <mat-icon>{{hide ? 'visibility_off' : 'visibility'}}</mat-icon>
        </button>
      </mat-form-field>
      <mat-form-field class="input">
        <input matInput type="text" name="name" [(ngModel)]= 'user.name' required placeholder="Enter name">
      </mat-form-field>
      <mat-form-field class="input">
        <input matInput type="text" name="contactNumber" [(ngModel)]= 'user.contactNumber' required placeholder="Enter contactNumber">
      </mat-form-field>
      <mat-form-field class="input">
        <mat-select placeholder="Select a user role" name = "role" [(ngModel)]='user.role'>
          <mat-option value = "Company User">Company User</mat-option>
          <mat-option value = "Field User">Field User</mat-option>
          <mat-option value = "Admin User">Admin User</mat-option>
        </mat-select>
      </mat-form-field>
      </mat-card-content>
      </mat-card>
      </div>

      <ng-container *ngIf = "user.role == 'Company User'">
      <div class="additionalUserDetails">
      <mat-card class="userForm">
        <mat-card-header class="header">
          Company User Additional Details
        </mat-card-header>
        <mat-card-content>
          <mat-form-field class="input">
            <input matInput type="text" name="tallyUserName" [(ngModel)]= 'user.tallyUserName' placeholder="Enter Tally username" required>
          </mat-form-field>

          <!--GODOWN DIV-->
          <div class="salesDiv">
          <mat-form-field class="input">
            <mat-select placeholder = "Choose Godown" name = 'godownName' required (selectionChange)="this.addGodown($event.value)">
              <mat-option *ngFor = 'let name of godownNames' [value] = 'name._id'>{{name._id}}</mat-option>
            </mat-select>
          </mat-form-field>
          <table mat-table class="" aria-label="Elements" [(dataSource)]='godownDataSource'>
            <!-- Phone Number Column -->
            <ng-container matColumnDef="name">
              <th mat-header-cell *matHeaderCellDef>Name</th>
              <td mat-cell *matCellDef="let row">{{row}}</td>
            </ng-container>


            <ng-container matColumnDef="update">

              <th mat-header-cell *matHeaderCellDef>Remove</th>
              <td mat-cell *matCellDef="let row">
                  <button  mat-button color="warn" (click)='deleteGodown(row)' name="button">
                      <mat-icon aria-hidden="false">delete</mat-icon>
                  </button>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
          </table>

          </div>

          <!-- CASH LEDGER-->
          <div class="salesDiv">
          <mat-form-field class="input">
            <mat-select placeholder = "Choose Cash Ledger Name" name = 'cashLedgerName' required (selectionChange)="this.addCashLedger($event.value)">
              <mat-option *ngFor = 'let name of cashLedgers' [value] = 'name'>{{name}}</mat-option>
            </mat-select>
          </mat-form-field>

          <table mat-table class="" aria-label="Elements" [(dataSource)]='cashLedgerDataSource'>
            <!-- Phone Number Column -->
            <ng-container matColumnDef="name">
              <th mat-header-cell *matHeaderCellDef>Name</th>
              <td mat-cell *matCellDef="let row">{{row}}</td>
            </ng-container>


            <ng-container matColumnDef="update">

              <th mat-header-cell *matHeaderCellDef>Remove</th>
              <td mat-cell *matCellDef="let row">
                  <button  mat-button color="warn" (click)='deleteCashLedger(row)' name="button">
                      <mat-icon aria-hidden="false">delete</mat-icon>
                  </button>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
          </table>

          </div>

          <!--VOUCHERTYPE -->
          <div class="salesDiv">
          <mat-form-field class="input">
            <mat-select placeholder = "Choose Voucher Type Name" name = 'voucherTypeName' required (selectionChange)="this.addVoucherType($event.value)">
              <mat-option *ngFor = 'let name of voucherTypeNames' [value] = 'name'>{{name.voucherTypeName}}</mat-option>
            </mat-select>
          </mat-form-field>

          <table mat-table class="" aria-label="Elements" [(dataSource)]='voucherTypeDataSource'>

            <ng-container matColumnDef="name">
              <th mat-header-cell *matHeaderCellDef>Name</th>
              <td mat-cell *matCellDef="let row">{{row.voucherTypeName}}</td>
            </ng-container>


            <ng-container matColumnDef="update">

              <th mat-header-cell *matHeaderCellDef>Remove</th>
              <td mat-cell *matCellDef="let row">
                  <button  mat-button color="warn" (click)='deleteVoucherType(row)' name="button">
                      <mat-icon aria-hidden="false">delete</mat-icon>
                  </button>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
          </table>

          </div>

<div class="voucherTypeDescription" *ngFor= "let v of user.salesVocherSettings.voucherTypeList">
  <mat-card>
    <mat-card-header>
        <b>{{v.voucherTypeName}}</b>
    </mat-card-header>
    <mat-card-content>
      <div class="salesDiv">
      <mat-form-field class="input">
        <input #posClass matInput type="text" name="POSClassName" placeholder="Enter POS Class">
        <button  mat-button color="warn" (click)='addPOSClass(v.voucherTypeName)' name="addPOSClass">
            <mat-icon aria-hidden="false">add</mat-icon>
        </button>
      </mat-form-field>

      <table mat-table class="" aria-label="Elements" [(dataSource)]='posClassDataSource'>

        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef>Name</th>
          <td mat-cell *matCellDef="let row">{{row.voucherTypeName}}</td>
        </ng-container>


        <ng-container matColumnDef="update">

          <th mat-header-cell *matHeaderCellDef>Remove</th>
          <td mat-cell *matCellDef="let row">
              <button  mat-button color="warn" (click)='deleteVoucherType(row)' name="button">
                  <mat-icon aria-hidden="false">delete</mat-icon>
              </button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>

      </div>
    </mat-card-content>
  </mat-card>

</div>


            <input name = "fileInput"  style="display: none" type="file" (change)="onFileChanged($event)" #fileInput>
            <button mat-raised-button (click) = "fileInput.click()" type= 'button' name="button">Select File</button>
            <img [src]="url" height="200"> <br/>
        </mat-card-content>
      </mat-card>
    </div>
    </ng-container>
    <ng-container>
      <button class="btn btn-lg btn-block btn-primary mb-3" type="submit" name="button"> Save </button>
    </ng-container>



  </form>

</div>
