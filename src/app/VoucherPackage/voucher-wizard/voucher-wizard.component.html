
<div>
  <mat-spinner *ngIf = "saving"></mat-spinner>
  <div style="height: 250px; padding-top: 50px;" *ngIf = "loading">
    <mat-spinner class="mx-auto" *ngIf = "loading"></mat-spinner>
    <div class="blockquote text-center" style="padding-top: 20px;">
      We are getting things ready...
    </div>
  </div>
<form>


  <mat-horizontal-stepper *ngIf = "!loading" (selectionChange)="setSelect($event, stepper)" linear = true labelPosition="bottom" #stepper>
    <mat-step [completed] = "this.voucher.VOUCHERTYPENAME && this.voucher.PRICELEVEL
     && this.godownName  && this.voucher.DATE">
        <ng-template matStepLabel>Voucher Details</ng-template>
        <div class = "row">
        <div class = "col">
          <mat-form-field>
            <mat-label>Select a Voucher Type</mat-label>
            <mat-select [(ngModel)] = "voucherType" required 
            name = "voucherTypeSelectSales" (selectionChange) = "getVoucherType($event.value)">
                    <mat-option [value] = "null">Not Applicable</mat-option>
                    <ng-container *ngFor = 'let v of user.voucherTypes'>
                        
                        <mat-option  *ngIf = "v.voucherCategory == 'Sales'" [value] = "v" >
                            {{v.voucherTypeName}}
                        </mat-option>
                    </ng-container>
            </mat-select>
          </mat-form-field>
        </div>
          

        <div class ="col">
          <mat-form-field>
            <mat-label>Select a Price Level</mat-label>
            <mat-select required [(ngModel)] = "voucher.PRICELEVEL" name = "priceSelect"
            (selectionChange) = "this.databaseService.savePriceList($event.value); setNewVoucher()">
                    <mat-option [value] = "null">Not Applicable</mat-option>
                    <mat-option *ngFor = 'let v of user.salesVoucherSettings.priceLists' [value] = "v">
                        {{v}}
                    </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        
    
        <div class="col">
          <mat-form-field>
            <mat-label>Select a Godown</mat-label>
            <mat-select [(ngModel)] = "godownName" required name= 'godownSelect'
            (selectionChange) = "this.databaseService.saveGodown($event.value); setNewVoucher()">
                    <mat-option [value] = "null">Not Applicable</mat-option>
                    <mat-option *ngFor = 'let v of user.godownList' [value] = "v">
                        {{v}}
                    </mat-option>
            </mat-select>
          </mat-form-field>
        </div>

        <div class = "col">
          <mat-form-field>
            <mat-label>Choose a date</mat-label>
            <input matInput required [(ngModel)] = "voucher.DATE" name = "voucherDate" [matDatepicker]="picker">
            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
          </mat-form-field>
        </div>
      </div>

        <!-- <div class = "row">
          <div class="col" *ngIf = "(createOnline$() | async) && databaseService.numberOfCacheVoucher">
            <div class="row">
              <p>There are currently {{databaseService.numberOfCacheVoucher}} vouchers offline</p><br>
              
            </div>
            <button mat-button  (click) = "this.databaseService.syncAllCacheVouchers()">
              <mat-icon>cloud_upload</mat-icon> Upload Vouchers
            </button>
            
          </div>
        </div> -->
        
        <div class="row" style="float: right;">
          <button mat-button matStepperNext>Next</button>
        </div>
    </mat-step>
    







    <!-- CUSTOMER TAB -->
    <!-- ------------------------------------------------------------------------------------------ -->
    <mat-step [completed] = "this.customer && this.customer.id">
      
        <ng-template matStepLabel>Customer Details</ng-template>
        <div class="row">
          <div class = "col">
            <ng-container *ngIf = "!customerCreationActive">
              <div class="row">
                <div class = "col">
                <auto-complete #customerAutoComp type="customer" [listProvided] = "true" [list] = "customers" name = "customer" (optionSelected) = "addCustomer($event.option.value, stepper)"></auto-complete>
                </div>
                <div class = "col">
                  <button mat-button color="accent" (click)='createNewCustomer()' name="button" class="createButton">
                    <mat-icon aria-hidden="false" aria-label="Example home icon">add</mat-icon>
                  </button>
                </div>
              </div>
              <div *ngIf = "customer">
                <div class = "row">
                  <div class="col">
                    <mat-form-field>
                      <label>Name</label>
                      <input matInput readonly [(ngModel)] = "customer.name" name = "customerName">
                    </mat-form-field>
                  </div>
                  <div class="col">
                    <mat-form-field>
                      <label>Father Name</label>
                      <input matInput readonly [(ngModel)] = "customer.fatherName" name = "customerFatherName">
                    </mat-form-field>
                  </div>
                </div>
                <div class = "row">
                  <div class="col">
                    <mat-form-field>
                      <label>Phone Number</label>
                      <input matInput readonly [(ngModel)] = "customer.phoneNumber" name = "phoneNumber">
                    </mat-form-field>
                  </div>
                  <div class="col">
                    <mat-form-field>
                      <label>LandHolding</label>
                      <input matInput readonly [(ngModel)] = "customer.landHolding" name = "customerLandHolding">
                    </mat-form-field>
                  </div>
                </div>
                <div class = "row" *ngIf = "customer.fullAddress">
                  <div class="col" >
                    <mat-form-field>
                      <label>Village</label>
                      <input matInput readonly [(ngModel)] = "customer.fullAddress.name" name = "addressName">
                    </mat-form-field>
                  </div>
                  <div class="col">
                    <mat-form-field>
                      <label>Tehsil</label>
                      <input matInput readonly [(ngModel)] = "customer.fullAddress.tehsilName" name = "addressTehsilName">
                    </mat-form-field>
                  </div>
                  <div class="col">
                    <mat-form-field>
                      <label>District</label>
                      <input matInput readonly [(ngModel)] = "customer.fullAddress.districtName" name = "addressDistrictName">
                    </mat-form-field>
                  </div>
                  <div class="col">
                    <mat-form-field>
                      <label>State</label>
                      <input matInput readonly [(ngModel)] = "customer.fullAddress.stateName" name = "addressStateName">
                    </mat-form-field>
                  </div>
                </div>
              </div>
            </ng-container>
            
          </div>
          <div class = "col">
            <div class= "row"  >
              <div class="col">
                <button  [disabled] = "!(customer && customer.id)" mat-raised-button (click) = "viewCustomerProfile(customer.id)">View Customer Profile</button>
              </div>
            </div>
            <div class="row" *ngIf = "customerCreationActive">
              <form #customerForm = "ngForm">

          
                <div class="col">
                  <div class="row">
                    <div class="col">
                    <mat-form-field>
                      <input #createCustomerNameRef matInput required [(ngModel)] = "createCustomer.name" placeholder="Enter Name"  name = "customerName" (keydown.enter) ="fatherNameRef.focus();false" >
                    </mat-form-field>
                    </div>
                    <div class="col">
                    <mat-form-field>
                      <input #fatherNameRef required matInput placeholder="Enter Father Name" name = "fatherName" [(ngModel)]="createCustomer.fatherName" (keydown.enter) ="landHolding.focus();false">
                    </mat-form-field>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col">
                      <mat-form-field>
                      <input #landHolding type= "number" matInput [(ngModel)] = "createCustomer.landHolding" placeholder="Enter Land Holding" name = "landHolding" (keydown.enter) ="phoneNumber.focus();false">
                    </mat-form-field>
                    </div>
                    <div class="col">
                      <mat-form-field>
                      <input #phoneNumber matInput placeholder="Enter Phone Number" name = "phoneNumber" [(ngModel)]="createCustomer.phoneNumber" (keydown.enter) ="addressRef.focus();false">
                    </mat-form-field>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col">
                      <mat-form-field style="width: 150px;">
                        <mat-label>Pick an Address</mat-label>
                        <input #addressRef type="text"
                               name = "address"
                               matInput
                               required
                               [formControl]="addressControl"
                               [(ngModel)] = "address"
                               [matAutocomplete]="auto">  
                        <mat-autocomplete [panelWidth]="600" #auto="matAutocomplete"
                                          [displayWith]= "displayFnAddress" (optionSelected) = "cd.detectChanges(); saveButton.focus()">
                                        
                          <mat-option *ngFor="let option of addressFilteredOptions | async" [value]="option">
                            <th scope="row">
                              <div class="p-2">
                                <div class="ml-3 d-inline-block align-middle">
                                  <h6 class="mb-0 font-weight-bold">{{option.name}}, {{option.tehsilName}}, {{option.districtName}}, {{option.stateName}}</h6>
                                </div>
                              </div>
                            </th>
                          </mat-option>
                        </mat-autocomplete>
                      </mat-form-field>
                    </div>
                    <div class="col">
                      <mat-form-field>
                      <input #consumerType placeholder="Customer Type" matInput type="text" readonly name = "customerType" [(ngModel)]="createCustomer.gSTREGISTRATIONTYPE">
                    </mat-form-field>
                    </div>
    
                  </div>
                  <div class="row">
                    <div class="col">
                      <button style="float: right;"  mat-button (click) = "customerCreationActive = false">Cancel</button>

                    </div>
                    <div class="col">
                      <button style="float: right;" #saveButton mat-button [disabled] = "disableSaveButton || customerForm.invalid || !address || !address.name" (click) = "submit(stepper)">Save</button>

                    </div>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
        <div style="float: right;">
          <button mat-button matStepperPrevious >Back</button>
          <button mat-button matStepperNext>Next</button>
        </div>
    
    </mat-step>

    <mat-step #invStep [completed] = "this.voucher.ALLINVENTORYENTRIES_LIST.length > 0">
      <ng-template matStepLabel>Inventory Details</ng-template>
      <div class = "col">
        <div class = "row">
            <!-- PRODUCT ENTRY GOES HERE -->
              <div class="col">
                <auto-complete #productAutoComp [listProvided] = "true"  [list] = "products" type="product" (optionSelected) = "selectInventory(stepper, $event)"></auto-complete>
              </div>
              <div class="col">
                <mat-form-field>
                  <input #quantityField type= "number" (keydown.enter) = "rateRef.nativeElement.focus();false" [placeholder] = "this.productAutoComp.productControl.value ? 'Enter '+this.productAutoComplete.productControl.value.baseUnits : 'Enter Qty'" matInput name ="qty" [formControl] = "qtyControl">
                </mat-form-field>
                
              </div>
              <div class="col">
                <mat-form-field *ngIf = "this.productAutoComp.productControl.value">
                  <input #rateField type= "number" (keydown.enter) = "setRateInclusiveOfTax();false" placeholder="Enter Rate" matInput name ="rate" [formControl] = "rateControl">
                </mat-form-field>
              </div>
              <div class="col">
                <mat-form-field *ngIf = "this.productAutoComp.productControl.value">
                  <input type= "number" readonly placeholder="Rate (inc of tax)"  matInput name ="rateIncTax" [formControl] = "rateIncControl">
                </mat-form-field>
              </div>
              <div class="col">
                <mat-form-field *ngIf = "productAutoComp.productControl.value">
                  <mat-select style="width: 600px; height: 200px;" #batchField style= "widows: 400px;" placeholder = "Select batch" [formControl] = "batchControl"
                  (selectionChange) = "validateInventoryEntry()">
                    <mat-option style="width: 400px;" *ngFor = "let batch of productAutoComp.productControl.value.BATCHES" [value] = "batch">
                      <span>{{batch.NAME}}</span>
                      <span style="padding-left: 20px;">BAL: {{batch.CLOSINGBALANCE}}</span>
                      <span>
                        <small style="float: right;">EXP: {{batch.EXPIRYDATE}}</small>
                      
                      </span>
                      <div>
                        
                      </div>
                    </mat-option>
                  </mat-select>
                </mat-form-field>
              </div>
            
          
        </div>
      <div class="row">
        

        <div class="col" *ngIf = "voucher.ALLINVENTORYENTRIES_LIST && voucher.LEDGERENTRIES_LIST">
          <mat-accordion>
            <ng-container  *ngFor = "let ledger of voucher.LEDGERENTRIES_LIST; let i = index">
              <mat-expansion-panel *ngIf = "!ledger.POSPAYMENTTYPE">
                <mat-expansion-panel-header>
                  <mat-panel-title>
                    
                      {{ledger.LEDGERNAME}}
          
                  </mat-panel-title>
                  <mat-panel-description>
                    <div style="float: left;">{{ledger.AMOUNT | currency:'INR'}}</div>
                  </mat-panel-description>
                </mat-expansion-panel-header>
                <!-- ENTER DESCRIPTION OF THE ITEM HERE -->
                <div class="col">
                  <div class = "row">
                    <div class="col">
                      <mat-form-field> 
                        <input type = 'number' matInput [name]="ledger.LEDGERNAME" placeholder = "Amount" [readonly] = "ledger.METHODTYPE != 'As User Defined Value'" [(ngModel)] = "ledger.AMOUNT">
                      </mat-form-field>
                    </div>
                    
                    
                  </div>
                  <div class="row">
                    
                    
                  </div>
                  
                </div>
                
                
              </mat-expansion-panel>
            </ng-container>
           
          </mat-accordion>
        </div>

        <div class="col">
          <mat-accordion>
            <mat-expansion-panel *ngFor = "let product of voucher.ALLINVENTORYENTRIES_LIST; let i = index">
              <mat-expansion-panel-header>
                <mat-panel-title>
                  
                    {{product.STOCKITEMNAME}}
        
                  
                </mat-panel-title>
                <mat-panel-description style="width: 200px;">
                  <div style="float: left;">Qty: {{product.ACTUALQTY}}</div>
                  <div style="width: 50px;"></div>
                  <div style="float: right;">Amount: {{product.AMOUNT}}</div>
                  <button mat-button color="warn" name="button" (click)="this.deleteStockItem(i)">
                    <mat-icon aria-hidden="false" aria-label="Example home icon">delete</mat-icon>
                  </button>
                </mat-panel-description>
              </mat-expansion-panel-header>
              <!-- ENTER DESCRIPTION OF THE ITEM HERE -->
              <div class="col">
                <div class = "row">
                  <div class="col">
                    <mat-form-field>
                      <input matInput placeholder = "Batch Name" readonly [value] = "product.BATCHALLOCATIONS_LIST.BATCHNAME">
                    </mat-form-field>
                  </div>
                  <div class="col">
                    <mat-form-field>
                      <input matInput placeholder = "Batch Expiry Date" readonly [value] = "product.BATCHALLOCATIONS_LIST.EXPIRYPERIOD.DATE">
                    </mat-form-field>
                  </div>
                  
                </div>
                <div class="row">
                  <div class = "col">
                    <mat-form-field>
                      <input matInput placeholder = "Rate" readonly [value] = "product.RATE">
                    </mat-form-field>
                  </div>
                  <div class="col">
                    <button mat-button color="warn" name="button" (click)="this.deleteStockItem(i)">
                      <mat-icon aria-hidden="false" aria-label="Example home icon">delete</mat-icon>
                    </button>
                  </div>
                  
                </div>
                
              </div>
              
              
            </mat-expansion-panel>
           
          </mat-accordion>
         
        </div>
        
      </div>
      </div>
      
      <div style="float: right;">
        <button mat-button matStepperPrevious>Back</button>
        <button mat-button matStepperNext>Next</button>
      </div>
    </mat-step>

    <mat-step>
      <ng-template matStepLabel>Payment Details</ng-template>
      <div class="row">
        <div class="col">
          <mat-accordion>
            <ng-container  *ngFor = "let ledger of voucher.LEDGERENTRIES_LIST; let i = index">
              <mat-expansion-panel *ngIf = "ledger.POSPAYMENTTYPE">
                <mat-expansion-panel-header>
                  <mat-panel-title>
                    
                      {{ledger.POSPAYMENTTYPE}}
          
                  </mat-panel-title>
                  <mat-panel-description>
                    <div style="float: left;">{{ledger.AMOUNT | currency:'INR'}}</div>
                  </mat-panel-description>
                </mat-expansion-panel-header>
                <!-- ENTER DESCRIPTION OF THE ITEM HERE -->
                <div class="col">
                  <div class = "row">
                    <div class="col">
                      <mat-form-field> 
                        <mat-select placeholder= "Select ledger" [name]="ledger.POSPAYMENTTYPE" [(ngModel)] = "ledger.LEDGERNAME">
                          <ng-container *ngIf = "ledger.POSPAYMENTTYPE == 'Gift'">
                            <mat-option *ngFor = "let led of sundryDebtors" [value] = "led.NAME">{{led.NAME}}</mat-option>
                          </ng-container>
                          
                          <ng-container *ngIf = "ledger.POSPAYMENTTYPE == 'Cash'">
                            <ng-container *ngFor = "let led of user.cashBankProfile">
                              <mat-option *ngIf = "led.type == 'Cash-in-hand'" [value] = "led.ledger">{{led.ledger}}</mat-option>
                            </ng-container>
                          </ng-container>

                          <ng-container *ngIf = "ledger.POSPAYMENTTYPE == 'Card'">
                            <ng-container *ngFor = "let led of user.cashBankProfile">
                              <mat-option *ngIf = "led.type == 'Bank Accounts' || led.type == 'Bank OD A/c'" [value] = "led.ledger">{{led.ledger}}</mat-option>
                            </ng-container>
                          </ng-container>
                          <ng-container *ngIf = "ledger.POSPAYMENTTYPE == 'Cheque'">
                            <ng-container *ngFor = "let led of user.cashBankProfile">
                              <mat-option *ngIf = "led.type == 'Bank Accounts' || led.type == 'Bank OD A/c'" [value] = "led.ledger">{{led.ledger}}</mat-option>
                            </ng-container>
                          </ng-container>
                          
                        </mat-select>
                      </mat-form-field>
                    </div>
                    <div class="col">
                      <mat-form-field *ngIf = "ledger.LEDGERNAME"> 
                        <input type = 'number' matInput [name]="ledger.LEDGERNAME" placeholder = "Amount"  [(ngModel)] = "ledger.AMOUNT">
                      </mat-form-field>
                    </div>
                    
                    
                  </div>
                  <div class="row">
                    
                    
                  </div>
                  
                </div>
                
                
              </mat-expansion-panel>
            </ng-container>
           
          </mat-accordion>
        </div>
        <div class = "col">
          <div class="row">
            <div class="col">
              <mat-form-field>
                <input matInput placeholder="Total" readonly name="voucherTotal" [value] = "voucher.getTotal()">
              </mat-form-field>
            </div>
            <div class="col">
              <mat-form-field *ngIf = "voucher.ALLINVENTORYENTRIES_LIST.length > 0">
                <input matInput placeholder="Remaining Balance" readonly name="voucherRemainingBalance" [value] = "getRemainingBalance()">
              </mat-form-field>
            </div>
          </div>
          
        </div>
      </div>


      <div style="float: right;">
        <button mat-button matStepperPrevious>Back</button>
        <button mat-button matStepperNext>Next</button>
      </div>
    </mat-step>

    <mat-step *ngIf = "cashLedger && cashLedger.AMOUNT != 0" [completed] = "voucher.POSCASHRECEIVED >= cashLedger.AMOUNT">
      <ng-template matStepLabel>Cash Tendered</ng-template>
      <div class="row">
        <div class="col">
          <mat-form-field>
            <input matInput placeholder="Total Cash Amount" readonly name="cashAmount" [(ngModel)] = "cashLedger.AMOUNT">
          </mat-form-field>
        </div>
        <div class="col">
          <mat-form-field>
            <input #cashRecievedField matInput placeholder="Enter Cash Recieved" name="cashRecieved" [(ngModel)] = "voucher.POSCASHRECEIVED">
          </mat-form-field>
        </div>
        <div class="col">
          <mat-form-field *ngIf = "voucher.POSCASHRECEIVED">
            <input matInput placeholder="Cash Tendered" readonly name="cashTendered" [value] = "voucher.POSCASHRECEIVED - cashLedger.AMOUNT">
          </mat-form-field>
        </div>
      </div>

      <div style="float: right;">
        <button mat-button matStepperPrevious>Back</button>
        <button mat-button matStepperNext>Next</button>
      </div>
    </mat-step>

    <mat-step [completed] = "true">
      <ng-template matStepLabel>Done</ng-template>
      <p>Voucher Completed</p>
      <!-- <section *ngIf = "!disableSaveOption" >
        <mat-checkbox name ="saveOffline" [(ngModel)]="saveOffline">Save Offline</mat-checkbox>
      </section> -->
      <div style="float: right;">
        <button mat-button matStepperPrevious>Back</button>
        <button matStepperNext mat-button>Next</button>
      </div>
    </mat-step>
    <mat-step>
      <ng-template matStepLabel>Print</ng-template>



      <div id="app" class="container invoice">
        <div class="row">
            <!-- data -->
            <div class="col-3 data py-4">
                <div class="line mt-4 mb-4"></div>
                <h1 *ngIf = "match()">DELIVERY MEMO</h1>
                <h3 *ngIf = "!match()">INVOICE</h3>
     
                <div class="data-box">
                    <div class="data-separator d-block my-2"></div>
                    <h4 class="text-muted font-weight-light" *ngIf = "match()">Memo No.</h4>
                    <h4 class="text-muted font-weight-light" *ngIf = "!match()">No.</h4>
                    <h4 class="font-weight-bold">{{voucher.VOUCHERNUMBER}}</h4>
                </div>
                <div class="data-box">
                    <div class="data-separator d-block my-2"></div>
                    <h4 class="text-muted font-weight-light">DATE</h4>
                    <h4 class="font-weight-bold">{{voucher.DATE | date: "MMMM dd, yyyy"}}</h4>
                </div>
                <div class="data-box">
                    <div class="data-separator d-block my-2"></div>
                    <h4 class="text-muted font-weight-light">TOTAL</h4>
                    <h4 class="font-weight-bold">{{getTotal() | currency: 'INR'}}</h4>
                </div>
                <div class="data-box" *ngIf = "printConf">
                     <h5 class="font-weight-bold">LICENSES</h5>
                     <ng-container *ngFor = "let ln of printConf.licenseNumbers">
                         <p><strong>{{ln? ln.licenseName : ""}}</strong> <br> {{ln? ln.licenseNumber :""}}</p>
                        
                     </ng-container>
                 </div>
                <div class="data-box">
                    <h5 class="font-weight-bold">PAYMENT METHODS</h5>
                    <ng-container *ngFor = "let ledger of voucher.LEDGERENTRIES_LIST">
                         <div style="width: 100%;" *ngIf = "ledger.POSPAYMENTTYPE && ledger.AMOUNT">
                             <span class="font-weight-light" style="width: 70%; float: left;">{{ledger.POSPAYMENTTYPE == "Gift" ? "On Account" : ledger.POSPAYMENTTYPE}}</span>
                             <span class="font-weight-light" style="width: 30%; float: right;">{{(ledger.AMOUNT) | currency: 'INR'}}</span>
                         </div>
                     </ng-container>
                </div>
                <div class="data-box align-text-bottom" style="width: 100% !important;">
                     <img src="http://agrostop.herokuapp.com/assets/img/agrostop_black.png" alt="Agrostop" class="img-fluid">
                </div>
            </div>
            <!-- end data -->
     
            <!-- content -->
            <div class="col-9 content py-4">
                <div class="line mt-4 mb-4"></div>
                <!-- header -->
                <div class="header">
                    <div class="row">
                        <div class="col-6 from" *ngIf = "printConf">
                            <span class="d-block font-weight-light">FROM:</span>
                            <h4>{{printConf.name}}</h4>
                            <ng-container *ngFor = "let address of printConf.address">
                             <span class="d-block font-weight-light">{{address}}</span>
                            </ng-container>
                            <span class="d-block font-weight-light">{{printConf.contactNumber}}</span>
                            <span class="d-block font-weight-light">{{printConf.emailId}}</span>
                        </div>
                        <div class="col-6 to" *ngIf = "customer">
                            <span class="d-block font-weight-light">TO:</span>
                            <h4>{{customer.name}}</h4>
                            <span class="d-block font-weight-light">S/O {{customer.fatherName}}</span>
                            <div *ngIf = "address">
                                 <span class="d-block font-weight-light">{{address.name}}, {{address.districtName}}</span>
                                 <span class="d-block font-weight-light">{{address.stateName}}</span>
                            </div>
                            <span class="d-block font-weight-light">{{customer.customerId}}</span>
                        </div>
                        <div class="col-6 to" *ngIf = "!customer">
                             <span class="d-block font-weight-light">TO:</span>
                             <h4>{{voucher.BASICBUYERNAME}}</h4>
                             <span class="d-block font-weight-light">{{voucher.ADDRESS_LIST ? voucher.ADDRESS_LIST.ADDRESS: ""}}</span>
                         </div>
                    </div>
                </div>
                <!-- end header -->
     
                <!-- note -->
                <!-- <div class="row my-4">
                    <div class="col-12">
                        <p class="text-justify">Quis sunt mollit nostrud aliqua consectetur voluptate eiusmod proident aute laboris non reprehenderit magna qui. Esse occaecat laboris laborum dolore excepteur enim laboris.</p>
                    </div>
                </div> -->
                <!-- end note -->
     
                <!-- items-header -->
                <div class="items-header">
                    <div class="row mt-4 items-header font-weight-bold">
                        <div class="col-12 my-2">
                            <div class="line"></div>
                        </div>
                        <div class="col-4">DESCRIPTION</div>
                        <div class="col-3 text-center">BATCH</div>
                        <div class="col-1 text-center">PRICE</div>
                        <div class="col-2 text-center">QTY</div>
                        <div class="col-1 text-right">TOTAL</div>
                        <div class="col-12 my-2">
                            <div class="line"></div>
                        </div>
                    </div>
                </div>
                <!-- end items-header -->
     
                <!-- items -->
                <div class="items">
                    <ng-container *ngFor = "let item of voucher.ALLINVENTORYENTRIES_LIST">
                         <div class="row mt-2 list-content">
                             <div class="col-4">
                                 <p class="without-margin">{{item.STOCKITEMNAME}} ({{item.tallyObject ? item.tallyObject.getHSNCODE(): "NA"}})</p>
                                 <p class="without-margin text-muted">
                                     <small>{{item.tallyObject && item.tallyObject.category
                                         ? item.tallyObject.category
                                         : ""}}</small>
                                 </p>
                             </div>
                             <div class="col-3 text-center">
                                 <p class="without-margin">{{item.BATCHALLOCATIONS_LIST.BATCHNAME}}</p>
                                 <p class="without-margin text-muted">
                                     <small><strong>EXP: </strong>{{item.BATCHALLOCATIONS_LIST.EXPIRYPERIOD.DATE}}</small>
                                 </p>
                             </div>
                             <div class="col-1 text-center">{{item.RATE | currency: "INR"}}</div>
                             <div class="col-2 text-center">{{item.BILLEDQTY}} {{item.tallyObject? item.tallyObject.baseUnits : ""}}</div>
                             <div class="col-1 text-right">{{item.RATE * item.BILLEDQTY | currency: "INR"}}</div>
                         </div>
                         <div class="row">
                             <div class="col-12 my-2">
                                 <div class="line-light"></div>
                             </div>
                         </div>
                    </ng-container>
                    
                </div>
                <!-- end items -->
     
                <!-- values -->
                <div class="values">
                    <div class="row">
                        <div class="col-12 my-2">
                            <div class="line"></div>
                        </div>
                    </div>
                    <div class="row mt-2 list-content">
                        <div class="col-10 font-weight-bold">
                            SUBTOTAL
                        </div>
                        <div class="col-2 text-right font-weight-bold">{{this.voucher.getSubTotal() | currency: "INR"}}</div>
                    </div>
                    <ng-container *ngFor = "let led of voucher.LEDGERENTRIES_LIST">
                     <div *ngIf = "led.METHODTYPE && led.AMOUNT && led.AMOUNT != 0" class="row mt-2 list-content">
                         <div class="col-10">
                             {{led.LEDGERNAME}}
                         </div>
                         <div class="col-2 text-right">{{led.AMOUNT | currency: 'INR'}}</div>
                     </div>
                    </ng-container>
                    
                     <div class="col-12 my-2">
                         <div class="line-end"></div>
                     </div>
                    <div class="row mt-2 list-content">
                        <div class="col-9">
                            <h3 class="font-weight-bold">TOTAL</h3>
                        </div>
                        <div class="col-3 text-right">
                            <h3 class="font-weight-bold">{{getTotal()| currency:'INR'}}</h3>
                        </div>
                    </div>
                </div>
                <!-- end values -->
     
     
     
     
                <!-- signature -->
                <div class="signature my-4" *ngIf= "user">
                    <div class="row">
                        <div class="col-12 text-right">
                            <h4 class="font-weight-bold">{{user.name}}</h4>
                            <span class="d-block font-weight-light">Authorised</span>
                        </div>
                    </div>
                </div>
                <!-- end signature -->
     
                <div class="items-header">
                     <div class="row mt-4 items-header font-weight-bold">
                         <div class="col-12 my-2">
                             <div class="line"></div>
                         </div>
                         <div class="col-3">HSNCODE</div>
                         <div class="col-2 text-center">CGST RATE</div>
                         <div class="col-2 text-center">CGST AMT</div>
                         
                         <div class="col-2 text-right">SGST RATE</div>
                         <div class="col-2 text-right">SGST AMT</div>
                         <div class="col-12 my-2">
                             <div class="line"></div>
                         </div>
                     </div>
                 </div>
     
                <div *ngIf = "hsnDetails" class = "items">
                 <ng-container *ngFor = "let tax of hsnDetails | keyvalue">
                     <div class="row mt-2 list-content">
                         <div class="col-3">
                             <p class="without-margin">{{tax.value.hsnCode}}</p>
                         </div>
                         <div class="col-2 text-center">{{tax.value.cgst.rate}}%</div>
                         <div class="col-2 text-center">{{tax.value.cgst.amount * 0.01 |  currency: 'INR' :true:'1.2-2'}}</div>
                         <div class="col-2 text-right">{{tax.value.sgst.rate}}%</div>
                         <div class="col-2 text-right">{{(tax.value.sgst.amount * 0.01) | currency: 'INR' :true:'1.2-2'}}</div>
                     </div>
                     <div class="row">
                         <div class="col-12 my-2">
                             <div class="line-light"></div>
                         </div>
                     </div>
                </ng-container>
                </div>
     
                <!-- gratitude -->
                <div class="gratitude my-4">
                     <ul *ngIf = "printConf">
                         <ng-container *ngFor = "let tc of printConf.termsAndConditions">
                             <li>{{tc}}</li>
                         </ng-container>
                         
                         <li *ngIf = "match()">Due to troubles in internet connectivity we are unable to provide you an invoice at this point. Please collect it later</li>
                         <li *ngIf = "voucher.NARRATION">NARRATION: {{voucher.NARRATION}}</li>
                     </ul>
                 </div>
                 <div class="gratitude text-center my-4">
                    <p class="text-muted">If not already done so, we recommend registering yourself with Agrostop for more tailored experiences.</p>
                    <h2>Thank you</h2>
                 </div>
              
            </div>
            <!-- end content -->
        </div>
     </div>
     
     <div>
         <button id="printButton" mat-raised-button style="float: right;" [useExistingCss]="true"
         
           printSectionId="app"
           ngxPrint>print</button>
     </div>



    </mat-step>
  </mat-horizontal-stepper>

</form>
</div>